[요청 내용]

Supabase Auth ↔ Influencer DB 연동 확인 및 보완

server 디렉토리에서 인증 관련 코드(auth 관련 파일, /api/auth/me, /auth/callback, 또는 비슷한 역할의 엔드포인트)를 모두 확인해 주세요.

Supabase Google 로그인이 성공했을 때:

Supabase의 user.id(혹은 sub)를 기준으로
influencers 테이블에 레코드를 upsert(없으면 생성, 있으면 업데이트)하도록 구현되어 있는지 확인해 주세요.

레코드에는 최소한 다음 정보가 저장되어야 합니다.

supabase_user_id

email

name 또는 display_name (가능한 경우)

만약 현재 구현에서 이 동기화가 빠져 있다면,

DatabaseStorage 또는 별도의 서비스 레이어에
syncInfluencerFromSupabaseUser(user) 형태의 헬퍼 함수를 만들고,

로그인/콜백 흐름에서 이 함수를 호출하도록 코드를 추가해 주세요.

/api/auth/me(또는 현재 사용 중인 "내 정보" API)가 다음 정보를 함께 반환하도록 보장해 주세요.

Supabase 세션/유저의 기본 정보 (id, email 등)

DB influencers 테이블의 레코드(프로필 정보, profileCompleted 플래그 등)

프론트엔드의 useAuth 훅에서 이 API 응답을 사용해

isAuthenticated,

influencer,

profileCompleted
값이 항상 최신 DB 상태를 반영하도록 확인/수정해 주세요.
(이미 구현되어 있다면, 현재 백엔드 응답과 타입이 잘 맞는지만 검증해 주세요.)

어드민 인플루언서/캠페인 페이지네이션 검증

server/databaseStorage.ts와 server/storage.ts를 확인해서

인플루언서 목록과 캠페인 목록을 가져오는 메서드에
page, pageSize 인자를 사용한 서버 사이드 페이지네이션이 구현되어 있는지 확인해 주세요.

DB 쿼리가 LIMIT/OFFSET 또는 그에 준하는 방식으로 최적화되어 있는지 확인해 주세요.

server/routes.ts에서 어드민용 엔드포인트(예: /api/admin/influencers, /api/admin/campaigns)가

쿼리 파라미터(?page=1&pageSize=20 등)를 받아서
DatabaseStorage의 페이지네이션 메서드를 호출하도록 되어 있는지 확인하고,
빠져 있다면 해당 부분을 추가해 주세요.

응답 형태는 다음 정보를 포함해야 합니다.

items: 현재 페이지의 인플루언서/캠페인 배열

total: 전체 레코드 수

page: 현재 페이지 번호

pageSize: 페이지 크기

(선택) totalPages: 총 페이지 수

client/src/pages/admin/AdminInfluencersPage.tsx 및
AdminCampaignListPage.tsx를 확인하여,

위 응답 형태를 기반으로 테이블 페이지네이션 UI가 정상 동작하도록
useQuery/상태 관리 부분이 맞춰져 있는지 검증하고,

필요하다면 최소한의 수정만으로 API 응답 구조와 일치시켜 주세요.

변경 범위 제한 & 주의사항

이미 잘 동작하고 있는 부분(특히 프론트엔드 UI와 기존 비즈니스 로직)은 가능한 한 건드리지 말고,
Supabase ↔ DB 동기화 + 어드민 페이지네이션에만 집중해 주세요.

TypeScript 타입 정의(@shared/schema 등)를 최대한 활용해서
백엔드/프론트엔드 간 타입 불일치가 없도록 해 주세요.

변경한 파일과 주요 변경사항을 요약해서 코멘트로 남겨 주세요.

[예상 결과]

인플루언서가 Google로 로그인/회원가입하면:

Supabase에는 Auth User가,

우리 Postgres DB에는 influencers 레코드가 항상 같이 생성/업데이트됩니다.

/api/auth/me와 useAuth를 통해, 프론트에서 항상 “Supabase 사용자 + 인플루언서 프로필” 정보를 일관되게 사용할 수 있습니다.

어드민 인플루언서/캠페인 리스트는 서버 사이드 페이지네이션을 사용하여,

데이터가 많아져도 페이지가 무겁지 않고,

PRD에서 정의된 “어드민이 한 눈에 상태를 볼 수 있는 대시보드” 요구사항을 만족하게 됩니다.